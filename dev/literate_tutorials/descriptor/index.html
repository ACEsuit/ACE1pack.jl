<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ACE Descriptors · ACE1pack.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://ACEsuit.github.io/ACE1pack.jl/literate_tutorials/descriptor/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ACE1pack.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../gettingstarted/installation/">Installation Instructions</a></li><li><a class="tocitem" href="../../gettingstarted/pkg/">Using the Julia Package Manager</a></li><li><a class="tocitem" href="../../gettingstarted/aceintro/">Introduction to ACE Models</a></li><li><a class="tocitem" href="../../gettingstarted/parallel-fitting/">Parallel Fitting</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/">Tutorials Overview</a></li><li><a class="tocitem" href="../first_example_model/">First example</a></li><li><a class="tocitem" href="../TiAl_model/">The <code>acemodel</code> interface from Julia (TiAl potential)</a></li><li><a class="tocitem" href="../TiAl_basis/">The <code>ace_basis</code> interface from Julia (TiAl)</a></li><li class="is-active"><a class="tocitem" href>ACE Descriptors</a></li><li><a class="tocitem" href="../committee/">Committee Potentials</a></li><li><a class="tocitem" href="../../tutorials/lammps/">ACE1pack potentials in LAMMPS</a></li><li><a class="tocitem" href="../../tutorials/python_ase/">python-<code>ase</code></a></li></ul></li><li><span class="tocitem">Command line</span><ul><li><a class="tocitem" href="../../tutorials/command_line_old/">OLD (!) Command line interface</a></li></ul></li><li><span class="tocitem">ACE1pack Internals</span><ul><li><a class="tocitem" href="../../ACE1pack/ace1pack_overview/">Overview</a></li><li><a class="tocitem" href="../../ACE1pack/fit/">Fitting ACE</a></li><li><a class="tocitem" href="../../ACE1pack/helpers/">Helper Functions</a></li><li><a class="tocitem" href="../../ACE1pack/data/">Handling Data</a></li><li><a class="tocitem" href="../../ACE1pack/basis/">Constructing Basis</a></li><li><a class="tocitem" href="../../ACE1pack/solver/">Solvers</a></li><li><a class="tocitem" href="../../ACE1pack/all_exported/">All ACE1pack functions</a></li></ul></li><li><span class="tocitem">ACEfit Internals</span><ul><li><a class="tocitem" href="../../ACEfit/Fitting/">ACE1 and ACEfit</a></li><li><a class="tocitem" href="../../ACEfit/Solvers/">Least squares solvers</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>ACE Descriptors</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ACE Descriptors</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ACEsuit/ACE1pack.jl/blob/main/tutorials/descriptor.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="ACE-Descriptors"><a class="docs-heading-anchor" href="#ACE-Descriptors">ACE Descriptors</a><a id="ACE-Descriptors-1"></a><a class="docs-heading-anchor-permalink" href="#ACE-Descriptors" title="Permalink"></a></h1><p>This tutorial demonstrates a simple use of ACE descriptors.</p><p>WARN: This tutorial is currently broken. It requires an update to the pair potential implementation.</p><pre><code class="language-julia hljs">using ACE1pack, LazyArtifacts, MultivariateStats, Plots</code></pre><p>Load a (tiny) silicon dataset, which has the isolated atom, 25 diamond-like configurations (dia), 25 beta-tin-like configurations and 2 liquid (liq) configurations.</p><pre><code class="language-julia hljs">dataset = read_extxyz(joinpath(ACE1pack.artifact(&quot;Si_tiny_dataset&quot;), &quot;Si_tiny.xyz&quot;));</code></pre><p>Define a basis.</p><pre><code class="language-julia hljs">basis = ACE1x.ace_basis(species = [:Si,],
      order = 3,        # correlation order = body-order - 1
      totaldegree = 12,  # polynomial degree
      r0 = 2.3,     # estimate for NN distance
      rcut = 5.5,)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">JuLIP.MLIPs.IPSuperBasis{JuLIP.MLIPs.IPBasis}(JuLIP.MLIPs.IPBasis[PolyPairBasis{ACE1.OrthPolys.TransformedPolys{Float64, ACE1.Transforms.Agnesi2Transform{Float64, Int64}, ACE1.OrthPolys.OrthPolyBasis{Float64}, PolyEnvelope{Float64}}, 1}(JuLIP.Potentials.SZList{1}(AtomicNumber[&lt;14&gt;]), ACE1.OrthPolys.TransformedPolys{Float64, ACE1.Transforms.Agnesi2Transform{Float64, Int64}, ACE1.OrthPolys.OrthPolyBasis{Float64}, PolyEnvelope{Float64}}[ACE1.OrthPolys.TransformedPolys{Float64, ACE1.Transforms.Agnesi2Transform{Float64, Int64}, ACE1.OrthPolys.OrthPolyBasis{Float64}, PolyEnvelope{Float64}}(ACE1.OrthPolys.OrthPolyBasis{Float64}(0, 0.6322976891387754, 0, 1.0, [0.9999999999999998, 9.420945272484992, 10.532952820247745, 10.726260946945121, 10.793129656156644, 10.823971950051892, 10.840722367320975, 10.850844569282172, 10.857444986420745, 10.862004485136394, 10.865301951886602, 10.867778868243485], [0.0, -7.688893598890059, -8.596457274149072, -8.754225478399015, -8.808800298159833, -8.833972200686318, -8.847643034386529, -8.85590425782166, -8.861291180642986, -8.865012410251571, -8.867703633929768, -8.869725166352522], [0.0, 0.0, -1.1180356658063584, -1.018352700329746, -1.0062341117321023, -1.0028575857863509, -1.0015475296264633, -1.0009337202465323, -1.0006082860275543, -1.000419942143015, -1.000303578106154, -1.0002279657175979], [0.632481540294206, 0.6328492426050673, 0.6332169449159285, 0.6335846472267898, 0.6339523495376509, 0.6343200518485121, 0.6346877541593734, 0.6350554564702346, 0.6354231587810959, 0.635790861091957  …  0.9965068280468183, 0.9968745303576796, 0.9972422326685408, 0.9976099349794021, 0.9979776372902632, 0.9983453396011245, 0.9987130419119857, 0.999080744222847, 0.9994484465337081, 0.9998161488445694], [0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001  …  0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001]), ACE1.Transforms.Agnesi2Transform{Float64, Int64}(2.3, 1, 3, 0.2857142857142857, 0.0), 0.0, 5.5, PolyEnvelope{Float64}(2, 2.3, 5.5));;], [0;;]), RPIBasis{Float64, BasicPSH1pBasis{Float64, 1, ACE1.OrthPolys.TransformedPolys{Float64, ACE1.Transforms.MultiTransform{1, ACE1.Transforms.AffineT{Float64, ACE1.Transforms.Agnesi2Transform{Float64, Int64}}}, ACE1.OrthPolys.OrthPolyBasis{Float64}, ACE1.OrthPolys.OneEnvelope}}, 1, ACE1.DAGEvaluator}(PIBasis{BasicPSH1pBasis{Float64, 1, ACE1.OrthPolys.TransformedPolys{Float64, ACE1.Transforms.MultiTransform{1, ACE1.Transforms.AffineT{Float64, ACE1.Transforms.Agnesi2Transform{Float64, Int64}}}, ACE1.OrthPolys.OrthPolyBasis{Float64}, ACE1.OrthPolys.OneEnvelope}}, 1, ACE1.DAGEvaluator}(BasicPSH1pBasis{Float64, 1, ACE1.OrthPolys.TransformedPolys{Float64, ACE1.Transforms.MultiTransform{1, ACE1.Transforms.AffineT{Float64, ACE1.Transforms.Agnesi2Transform{Float64, Int64}}}, ACE1.OrthPolys.OrthPolyBasis{Float64}, ACE1.OrthPolys.OneEnvelope}}(ACE1.OrthPolys.TransformedPolys{Float64, ACE1.Transforms.MultiTransform{1, ACE1.Transforms.AffineT{Float64, ACE1.Transforms.Agnesi2Transform{Float64, Int64}}}, ACE1.OrthPolys.OrthPolyBasis{Float64}, ACE1.OrthPolys.OneEnvelope}(ACE1.OrthPolys.OrthPolyBasis{Float64}(2, -1.0, 2, 1.0, [1.5687375497513916, 3.316624790355401, 2.6739483914241924, 2.430862174022013, 2.3048861143233235, 2.2291771507065796, 2.179449471771357, 2.1447610589554333, 2.11947811973324, 2.1004201260569073, 2.0856653614930205, 2.0739902138057946, 2.064582282328315, 2.0568833782436915, 2.0504988310623005, 2.0451427085842933, 2.040603465820524, 2.036721704555277, 2.033375370377712, 2.0304696591267], [0.0, -2.0786140873094945e-18, -7.017609472481619e-18, 2.412551411320251e-17, -4.62164749360015e-17, 8.442290037528487e-17, -1.036773538695508e-16, 1.0425048391689846e-16, -1.0935396246574519e-16, 1.1420171246516114e-16, -1.2236837934382784e-16, 1.182192736628651e-16, -8.383224079690349e-17, 1.6979098049736654e-16, -1.221008501891897e-16, 2.2883885653832353e-16, -2.753954957631153e-16, 2.490864486696935e-16, -3.011360817815889e-16, 1.9856740318865658e-16], [0.0, 0.0, -0.8062257748298566, -0.9090909090909166, -0.9481763873554975, -0.9671528397232887, -0.9776923610941106, -0.9840838646340674, -0.9882117688044432, -0.9910081668223438, -0.9929753269925167, -0.9944021951446381, -0.9954638496291572, -0.9962709628235593, -0.9968960091520394, -0.9973878929376258, -0.9977804762744835, -0.998097738570837, -0.998356999795269, -0.9985709912230949], [-0.999, -0.997, -0.995, -0.993, -0.991, -0.989, -0.987, -0.985, -0.983, -0.981  …  0.981, 0.983, 0.985, 0.987, 0.989, 0.991, 0.993, 0.995, 0.997, 0.999], [0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001  …  0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001]), ACE1.Transforms.MultiTransform{1, ACE1.Transforms.AffineT{Float64, ACE1.Transforms.Agnesi2Transform{Float64, Int64}}}(JuLIP.Potentials.SZList{1}(AtomicNumber[&lt;14&gt;]), ACE1.Transforms.AffineT{Float64, ACE1.Transforms.Agnesi2Transform{Float64, Int64}}[ACE1.Transforms.AffineT{Float64, ACE1.Transforms.Agnesi2Transform{Float64, Int64}}(ACE1.Transforms.Agnesi2Transform{Float64, Int64}(2.3, 2, 4, 0.7692307692307693, 0.0), 1.0, 0.21079316613916743, -1.0, 1.0);;]), 0.0, 5.500000000000001, ACE1.OrthPolys.OneEnvelope()), ACE1.SphericalHarmonics.SHBasis{Float64}(7, ACE1.SphericalHarmonics.ALPCoefficients{Float64}([6.90880566364076e-310, 6.90882446107023e-310, 6.90882553802187e-310, 1.9364916731037085, 6.9088255381373e-310, 6.9088255381373e-310, 1.9720265943665387, 2.091650066335189, 0.0, 0.0  …  6.9087862213165e-310, 6.9088255381373e-310, 1.9948914348241344, 2.0155644370746373, 2.0816659994661326, 2.207940216581962, 2.4308621740219887, 2.850438562747845, 6.90882446403067e-310, 6.90882553767405e-310], [6.9088216401372e-310, 6.9088216401372e-310, 6.9088216401372e-310, -0.5773502691896257, 6.9088216401372e-310, 6.9088216401372e-310, -0.5163977794943222, -0.4472135954999579, 6.9088216401372e-310, 6.9088216401372e-310  …  6.9088216401372e-310, 6.9088216401372e-310, -0.5017452060042545, -0.4947274449181537, -0.47304991679126607, -0.4345240946267408, -0.3739787960033829, -0.2773500981126146, 6.9087846852846e-310, 6.9088216401372e-310])), JuLIP.Potentials.SZList{1}(AtomicNumber[&lt;14&gt;]), ACE1.RPI.PSH1pBasisFcn[znlm[0|1,0,0], znlm[0|1,1,-1], znlm[0|1,1,0], znlm[0|1,1,1], znlm[0|1,2,-2], znlm[0|1,2,-1], znlm[0|1,2,0], znlm[0|1,2,1], znlm[0|1,2,2], znlm[0|1,3,-3]  …  znlm[0|11,0,0], znlm[0|12,0,0], znlm[0|13,0,0], znlm[0|14,0,0], znlm[0|15,0,0], znlm[0|16,0,0], znlm[0|17,0,0], znlm[0|18,0,0], znlm[0|19,0,0], znlm[0|20,0,0]], UnitRange{Int64}[1:296;;]), JuLIP.Potentials.SZList{1}(AtomicNumber[&lt;14&gt;]), (ACE1.InnerPIBasis([1, 1, 1, 1, 1, 1, 1, 1, 1, 1  …  3, 3, 3, 3, 3, 3, 3, 3, 3, 3], [1 0 0; 65 0 0; … ; 114 163 199; 163 163 163], Dict{ACE1.PIBasisFcn, Int64}(ACE1.PIBasisFcn{3, ACE1.RPI.PSH1pBasisFcn}(&lt;14&gt;, (znlm[14|1,1,-1], znlm[14|1,2,0], znlm[14|3,1,1]), ACE1.RPI.PSH1pBasisFcn) =&gt; 492, ACE1.PIBasisFcn{2, ACE1.RPI.PSH1pBasisFcn}(&lt;14&gt;, (znlm[14|1,5,-1], znlm[14|2,1,1]), ACE1.RPI.PSH1pBasisFcn) =&gt; 163, ACE1.PIBasisFcn{3, ACE1.RPI.PSH1pBasisFcn}(&lt;14&gt;, (znlm[14|1,2,-1], znlm[14|2,1,0], znlm[14|3,1,1]), ACE1.RPI.PSH1pBasisFcn) =&gt; 659, ACE1.PIBasisFcn{2, ACE1.RPI.PSH1pBasisFcn}(&lt;14&gt;, (znlm[14|1,3,1], znlm[14|2,3,-1]), ACE1.RPI.PSH1pBasisFcn) =&gt; 148, ACE1.PIBasisFcn{3, ACE1.RPI.PSH1pBasisFcn}(&lt;14&gt;, (znlm[14|2,1,0], znlm[14|3,0,0], znlm[14|3,1,0]), ACE1.RPI.PSH1pBasisFcn) =&gt; 768, ACE1.PIBasisFcn{1, ACE1.RPI.PSH1pBasisFcn}(&lt;14&gt;, (znlm[14|12,0,0],), ACE1.RPI.PSH1pBasisFcn) =&gt; 12, ACE1.PIBasisFcn{3, ACE1.RPI.PSH1pBasisFcn}(&lt;14&gt;, (znlm[14|1,1,0], znlm[14|2,1,0], znlm[14|6,0,0]), ACE1.RPI.PSH1pBasisFcn) =&gt; 579, ACE1.PIBasisFcn{3, ACE1.RPI.PSH1pBasisFcn}(&lt;14&gt;, (znlm[14|1,0,0], znlm[14|3,0,0], znlm[14|3,2,0]), ACE1.RPI.PSH1pBasisFcn) =&gt; 440, ACE1.PIBasisFcn{3, ACE1.RPI.PSH1pBasisFcn}(&lt;14&gt;, (znlm[14|1,1,1], znlm[14|1,1,1], znlm[14|2,2,-2]), ACE1.RPI.PSH1pBasisFcn) =&gt; 594, ACE1.PIBasisFcn{3, ACE1.RPI.PSH1pBasisFcn}(&lt;14&gt;, (znlm[14|2,0,0], znlm[14|3,0,0], znlm[14|6,0,0]), ACE1.RPI.PSH1pBasisFcn) =&gt; 742…), Dict{Any, Int64}(znlm[14|3,5,0] =&gt; 144, znlm[14|6,2,-1] =&gt; 229, znlm[14|6,4,1] =&gt; 245, znlm[14|9,1,1] =&gt; 277, znlm[14|1,4,-4] =&gt; 17, znlm[14|1,4,1] =&gt; 22, znlm[14|2,4,2] =&gt; 87, znlm[14|3,3,0] =&gt; 126, znlm[14|1,7,5] =&gt; 62, znlm[14|2,4,-1] =&gt; 84…), 1:786, &lt;14&gt;, ACE1.DAG.CorrEvalGraph{Int64, Int64}([(1, 0), (2, 0), (3, 0), (4, 0), (5, 0), (6, 0), (7, 0), (8, 0), (9, 0), (10, 0)  …  (415, 114), (415, 120), (415, 163), (415, 199), (415, 224), (114, 417), (114, 420), (416, 163), (416, 199), (425, 163)], [1, 0, 0, 0, 0, 0, 0, 0, 0, 0  …  777, 778, 779, 780, 781, 782, 783, 784, 785, 786], 296, 467)),), ACE1.DAGEvaluator()), (sparse([1, 3, 5, 12, 14, 16, 20, 22, 24, 25  …  191, 192, 193, 194, 195, 196, 196, 197, 198, 199], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 21, 25, 29, 32, 35, 38, 40, 42, 44, 45, 46, 47, 50, 53, 55, 57, 59, 60, 61, 62, 65, 68, 70, 72, 74, 75, 76, 79, 82, 84, 86, 88, 89, 90, 91, 93, 95, 96, 97, 98, 100, 102, 103, 104, 105, 108, 111, 113, 115, 120, 122, 123, 124, 126, 128, 129, 130, 131, 132, 133, 134, 135, 137, 141, 143, 148, 152, 153, 167, 170, 173, 176, 178, 180, 182, 183, 184, 185, 187, 189, 191, 192, 193, 194, 196, 198, 200, 201, 202, 204, 206, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 219, 221, 225, 226, 227, 228, 237, 240, 242, 244, 246, 247, 248, 249, 251, 252, 253, 254, 256, 257, 258, 260, 261, 262, 263, 264, 265, 269, 271, 273, 274, 275, 276, 277, 278, 279, 280, 282, 283, 284, 285, 286, 290, 293, 296, 299, 301, 303, 305, 306, 307, 308, 311, 313, 315, 317, 318, 319, 320, 323, 325, 327, 329, 330, 331, 334, 336, 338, 340, 341, 342, 343, 345, 346, 347, 348, 350, 351, 352, 353, 356, 358, 360, 365, 366, 367, 369, 370, 371, 372, 373, 374, 378, 388, 391, 394, 396, 398, 400, 401, 402, 403, 405, 407, 408, 409, 410, 412, 414, 415, 416, 418, 420, 421, 422, 423, 424, 425, 426, 427, 429, 433, 434, 439, 441, 443, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 458, 460, 461, 462, 463, 464, 465, 466, 467, 469, 470, 471, 472, 474, 475, 476, 477, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 505, 507, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 526, 527, 528, 529, 530, 531, 532, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 565, 567, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 586, 587, 588, 589, 590, 591, 592, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 614, 616, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 667, 669, 673, 674, 675, 676, 677, 678, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 705, 708, 710, 712, 714, 715, 716, 717, 719, 720, 721, 722, 724, 725, 726, 728, 729, 730, 731, 732, 733, 737, 739, 741, 742, 743, 744, 745, 746, 747, 748, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 777, 779, 780, 781, 782, 783, 784, 785, 786], [-0.5251768409363716, 0.07983916371558003, -0.008906071743684215, -0.9096329714603137, 0.13828548798919416, -0.015425768755914596, 1.1743311165423198, -0.17852579733477145, 0.01991458183136796, -1.3894873154481646  …  -0.5773502691896257, 2.449489742783178, 1.4142135623730951, 1.4142135623730951, 1.4142135623730951, -1.6329931618554525, 0.816496580927726, 1.4142135623730951, 1.0, 2.449489742783178], 199, 786),), (1:199,))])</code></pre><p>Compute an averaged structural descriptor for each configuration.</p><pre><code class="language- hljs">descriptors = []
config_types = []
for atoms in dataset
    descriptor = zeros(length(basis))
    for i in 1:length(atoms)
        descriptor += site_energy(basis, atoms, i)
    end
    descriptor /= length(atoms)
    push!(descriptors, descriptor)
    push!(config_types, atoms.data[&quot;config_type&quot;].data)
end</code></pre><p>Finally, extract the descriptor principal components and plot. Note the segregation by configuration type.</p><pre><code class="language- hljs">descriptors = hcat(descriptors...)
M = fit(PCA, descriptors; maxoutdim=3, pratio=1)
descriptors_trans = transform(M, descriptors)
p = scatter(
    descriptors_trans[1,:], descriptors_trans[2,:], descriptors_trans[3,:],
    marker=:circle, linewidth=0, group=config_types, legend=:right)
plot!(p, xlabel=&quot;PC1&quot;, ylabel=&quot;PC2&quot;, zlabel=&quot;PC3&quot;, camera=(40,10))</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../TiAl_basis/">« The <code>ace_basis</code> interface from Julia (TiAl)</a><a class="docs-footer-nextpage" href="../committee/">Committee Potentials »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 27 June 2023 15:08">Tuesday 27 June 2023</span>. Using Julia version 1.9.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
